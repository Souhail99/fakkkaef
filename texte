// Importez la bibliothèque `node-fetch` pour effectuer des requêtes HTTP.
const fetch = require('node-fetch');

// Fonction pour envoyer un email via SendGrid.
async function sendEmail(fromEmail, toEmail, subject, content) {
  // Créez un objet avec les informations de l'email.
  const email = {
    personalizations: [
      {
        to: [
          {
            email: toEmail
          }
        ]
      }
    ],
    from: {
      email: fromEmail
    },
    subject: subject,
    content: [
      {
        type: 'text/plain',
        value: content
      }
    ]
  };

  // Effectuez une requête POST vers l'API SendGrid pour envoyer l'email.
  const response = await fetch('https://api.sendgrid.com/v3/mail/send', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${process.env.SENDGRID_API_KEY}` // Remplacez `process.env.SENDGRID_API_KEY` par votre clé API SendGrid.
    },
    body: JSON.stringify(email)
  });

  // Vérifiez si la requête a été effectuée avec succès.
  if (response.status === 202) {
    console.log('Email sent successfully!');
  } else {
    console.error(`Failed to send email. Error: ${response.statusText}`);
  }
}



// Récupérez les informations de l'email.
const fromEmail = 'john.doe@example.com';
const toEmail = 'jane.doe@example.com';
const subject = 'Test Email';
const content = 'This is a test email.';

// Appelez la fonction `sendEmail` pour envoyer l'email.
sendEmail(fromEmail, toEmail, subject, content);
